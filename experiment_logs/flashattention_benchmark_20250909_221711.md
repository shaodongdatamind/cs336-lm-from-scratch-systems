| impl       | dtype    |   seq_len |   d_model |   batch | is_causal   |   forward_ms_mean |   forward_ms_std |   backward_ms_mean |   backward_ms_std |   e2e_ms_mean |   e2e_ms_std |
|:-----------|:---------|----------:|----------:|--------:|:------------|------------------:|-----------------:|-------------------:|------------------:|--------------:|-------------:|
| torch      | bfloat16 |       128 |        16 |       1 | True        |            0.3546 |           0.0038 |             0.3592 |            0.0097 |        0.8115 |       0.1716 |
| triton_fa2 | bfloat16 |       128 |        16 |       1 | True        |            0.0975 |           0.003  |             0.3529 |            0.0383 |        0.5433 |       0.075  |
| torch      | bfloat16 |       128 |        32 |       1 | True        |            0.155  |           0.0192 |             0.3839 |            0.0336 |        0.7809 |       0.1552 |
| triton_fa2 | bfloat16 |       128 |        32 |       1 | True        |            0.0754 |           0.0221 |             0.4025 |            0.0191 |        0.5255 |       0.0484 |
| torch      | bfloat16 |       128 |        64 |       1 | True        |            0.158  |           0.0118 |             0.3723 |            0.0203 |        0.6531 |       0.1549 |
| triton_fa2 | bfloat16 |       128 |        64 |       1 | True        |            0.1506 |           0.1185 |             0.4239 |            0.0417 |        0.527  |       0.0303 |
| torch      | bfloat16 |       128 |       128 |       1 | True        |            0.1536 |           0.0137 |             0.3648 |            0.0251 |        0.87   |       0.2235 |
| triton_fa2 | bfloat16 |       128 |       128 |       1 | True        |            0.103  |           0.0304 |             0.522  |            0.194  |        0.601  |       0.0437 |
| torch      | bfloat16 |       256 |        16 |       1 | True        |            0.1768 |           0.0474 |             0.3656 |            0.0234 |        0.6326 |       0.1314 |
| triton_fa2 | bfloat16 |       256 |        16 |       1 | True        |            0.0697 |           0.0019 |             0.4431 |            0.0507 |        0.6836 |       0.1006 |
| torch      | bfloat16 |       256 |        32 |       1 | True        |            0.157  |           0.011  |             0.4421 |            0.1053 |        0.6377 |       0.1207 |
| triton_fa2 | bfloat16 |       256 |        32 |       1 | True        |            0.0894 |           0.0287 |             0.5187 |            0.1725 |        0.6976 |       0.1594 |
| torch      | bfloat16 |       256 |        64 |       1 | True        |            0.157  |           0.0085 |             0.4307 |            0.1002 |        0.6681 |       0.0962 |
| triton_fa2 | bfloat16 |       256 |        64 |       1 | True        |            0.077  |           0.0067 |             0.3928 |            0.0184 |        0.6231 |       0.0966 |
| torch      | bfloat16 |       256 |       128 |       1 | True        |            0.166  |           0.0081 |             0.4192 |            0.1073 |        0.5934 |       0.0107 |
| triton_fa2 | bfloat16 |       256 |       128 |       1 | True        |            0.1104 |           0.0623 |             0.4424 |            0.0564 |        0.665  |       0.1634 |
| torch      | bfloat16 |       512 |        16 |       1 | True        |            0.1582 |           0.0086 |             0.4407 |            0.1014 |        0.8657 |       0.1276 |
| triton_fa2 | bfloat16 |       512 |        16 |       1 | True        |            0.0835 |           0.0074 |             0.6892 |            0.1252 |        0.5221 |       0.0372 |
| torch      | bfloat16 |       512 |        32 |       1 | True        |            0.1641 |           0.0211 |             0.4933 |            0.0677 |        0.7703 |       0.2336 |
| triton_fa2 | bfloat16 |       512 |        32 |       1 | True        |            0.0897 |           0.01   |             0.5645 |            0.1462 |        0.6546 |       0.1934 |
| torch      | bfloat16 |       512 |        64 |       1 | True        |            0.1586 |           0.0078 |             0.4366 |            0.1339 |        0.6608 |       0.1128 |
| triton_fa2 | bfloat16 |       512 |        64 |       1 | True        |            0.0927 |           0.0062 |             0.3932 |            0.0129 |        0.5015 |       0.0088 |
| torch      | bfloat16 |       512 |       128 |       1 | True        |            0.1749 |           0.0218 |             0.4119 |            0.0724 |        0.7403 |       0.1557 |
| triton_fa2 | bfloat16 |       512 |       128 |       1 | True        |            0.1058 |           0.0042 |             0.4096 |            0.0183 |        0.6634 |       0.1687 |
| torch      | float32  |       128 |        16 |       1 | True        |            0.1595 |           0.0122 |             0.3656 |            0.0503 |        0.5638 |       0.0168 |
| triton_fa2 | float32  |       128 |        16 |       1 | True        |            0.1144 |           0.0079 |             0.4547 |            0.1194 |        0.6195 |       0.0786 |
| torch      | float32  |       128 |        32 |       1 | True        |            0.1544 |           0.0119 |             0.3812 |            0.0805 |        0.7054 |       0.2287 |
| triton_fa2 | float32  |       128 |        32 |       1 | True        |            0.0761 |           0.0084 |             0.3948 |            0.0208 |        0.4987 |       0.0155 |
| torch      | float32  |       128 |        64 |       1 | True        |            0.2143 |           0.0599 |             0.3784 |            0.0758 |        0.6027 |       0.0621 |
| triton_fa2 | float32  |       128 |        64 |       1 | True        |            0.0858 |           0.018  |             0.3934 |            0.018  |        0.5333 |       0.0285 |
| torch      | float32  |       128 |       128 |       1 | True        |            0.179  |           0.0656 |             0.3636 |            0.0348 |        0.6468 |       0.1368 |
| triton_fa2 | float32  |       128 |       128 |       1 | True        |            0.1366 |           0.0227 |             0.4839 |            0.1038 |        0.5661 |       0.1235 |
| torch      | float32  |       256 |        16 |       1 | True        |            0.1555 |           0.0077 |             0.4467 |            0.0825 |        0.7354 |       0.1763 |
| triton_fa2 | float32  |       256 |        16 |       1 | True        |            0.0815 |           0.0332 |             0.402  |            0.0277 |        0.651  |       0.2017 |
| torch      | float32  |       256 |        32 |       1 | True        |            0.2344 |           0.0967 |             0.3556 |            0.0185 |        0.5745 |       0.0098 |
| triton_fa2 | float32  |       256 |        32 |       1 | True        |            0.0725 |           0.0009 |             0.4427 |            0.0565 |        0.575  |       0.0973 |
| torch      | float32  |       256 |        64 |       1 | True        |            0.1683 |           0.0234 |             0.4141 |            0.0469 |        0.6404 |       0.033  |
| triton_fa2 | float32  |       256 |        64 |       1 | True        |            0.0776 |           0.0035 |             0.4028 |            0.0148 |        0.577  |       0.0719 |
| torch      | float32  |       256 |       128 |       1 | True        |            0.1768 |           0.0356 |             0.5274 |            0.2045 |        0.6935 |       0.1376 |
| triton_fa2 | float32  |       256 |       128 |       1 | True        |            0.0842 |           0.0032 |             0.4367 |            0.0605 |        0.5794 |       0.0751 |
| torch      | float32  |       512 |        16 |       1 | True        |            0.16   |           0.012  |             0.3813 |            0.0426 |        0.8128 |       0.2043 |
| triton_fa2 | float32  |       512 |        16 |       1 | True        |            0.0833 |           0.0157 |             0.4524 |            0.0516 |        0.7446 |       0.2492 |
| torch      | float32  |       512 |        32 |       1 | True        |            0.1584 |           0.007  |             0.4268 |            0.1038 |        0.8878 |       0.1247 |
| triton_fa2 | float32  |       512 |        32 |       1 | True        |            0.0875 |           0.008  |             0.4002 |            0.0152 |        0.7203 |       0.1334 |
| torch      | float32  |       512 |        64 |       1 | True        |            0.1604 |           0.0084 |             0.4059 |            0.0922 |        0.7468 |       0.1725 |
| triton_fa2 | float32  |       512 |        64 |       1 | True        |            0.1005 |           0.0071 |             0.4153 |            0.0225 |        0.522  |       0.0174 |
| torch      | float32  |       512 |       128 |       1 | True        |            0.1647 |           0.0053 |             0.5235 |            0.2316 |        0.7731 |       0.208  |
| triton_fa2 | float32  |       512 |       128 |       1 | True        |            0.1095 |           0.0065 |             0.3955 |            0.0163 |        0.5775 |       0.1015 |
\

Overall, the Triton FlashAttention-2 forward pass is consistently faster than the plain PyTorch SDPA across dtypes and sizes, with the gap widening at larger d_model and sequence lengths. Backward is not implemented yet on triton.